
\documentclass[a4paper,10pt]{beamer}
\usepackage[T1,plmath]{polski}
\usepackage[cp1250]{inputenc}
\usepackage{amssymb}
\usepackage{indentfirst}
\usepackage{graphicx}

\usefonttheme[onlymath]{serif}


\usepackage{ulem} % kolorowe podkreœlenia
\usepackage{xcolor} % kolorowe podkreœlenia

\newcommand{\arcctg}{{\rm{arcctg}\,}}
\newcommand{\arctg}{{\rm{arctg}\,}}
\newcommand{\ddd}{{\,\rm{d}}}
\newcommand{\Int}{{\,\rm{Int}}}

%\definecolor{green1}{html}{22B14C}

\newcommand{\ouline}[1]{{\color{orange}\uline{{\color{black}#1}}}} % pomarañczowe podkreœlenie
\newcommand{\yuline}[1]{{\color{yellow}\uline{{\color{black}#1}}}} % ¿ó³te podkreœlenie
\newcommand{\buline}[1]{{\color{blue}\uline{{\color{black}#1}}}} % niebieskie podkreœlenie
\newcommand{\guline}[1]{{\color[RGB]{34,177,76}\uline{{\color{black}#1}}}} % zielone podkreœlenie


\usetheme{Boadilla}
\usecolortheme{crane}
%\usecolortheme[rgb={1,0.5,0}]{structure}

\title{\bf Rekurencja}
%\subtitle{Matematyka, Kierunek: Architektura}
\author[B. Pawlik]{\bf dr in¿. Bart³omiej Pawlik}
%\institute{}



%\setbeamercovered{transparent} % przezroczyste warstwy





\begin{document}




\begin{frame}
\titlepage
\end{frame}



%%%%%%%%%% CI¥GI REKURENCYJNE


\begin{frame}{Ci¹gi rekurencyjne}
	
	\begin{block}{}
		{\bf Rekurencja} (³ac. {\it recurrere} - przybiec z powrotem) to sposób definiowania procedur i funkcji polegaj¹cy na umieszczeniu w treœci procedury/funkcji odwo³añ do samej siebie.
	\end{block}

	W definicji rekurencyjnej podajemy jawnie pewn¹ liczbê elementów z których sk³ada siê dany obiekt ({\it warunki pocz¹tkowe} lub {\it przypadki bazowe}), a nastêpnie podajemy regu³y ({\it zale¿noœci rekurencyjne}) definiowania pozosta³ych elementów przy pomocy elementów zdefiniowanych wczeœniej.	
	
\end{frame}


\begin{frame}
	
	\begin{block}{Definicja}
		Funkcja jest zdefiniowana rekurencyjnie, je¿eli
		\begin{itemize}
			\item okreœlono (jawnie) wartoœci dla pewnego zbioru argumentów funkcji (warunki pocz¹tkowe)
			\item pozosta³e wartoœci s¹ zdefiniowane za pomoc¹ innych wartoœci tej funkcji poprzez zale¿noœæ rekurencyjn¹ (co najmniej jedn¹).
		\end{itemize}		
	\end{block}

	Funkcje rekurencyjne o co najwy¿ej przeliczalnym zbiorze warunków pocz¹tkowych oraz przeliczalnej liczbie zale¿noœci rekurencyjnych maj¹ przeliczaln¹ dziedzinê (wiêc s¹ ci¹gami).
	
\end{frame}


\begin{frame}
	
	\begin{exampleblock}{Podstawowe przyk³ady ci¹gów rekurencyjnych}
		Niech $a,g,r$ i $q$ bêd¹ liczbami rzeczywistymi i niech $g\neq0$, $q\neq0$.
		\begin{enumerate}
			\item silnia: $\displaystyle n!=\left\{\begin{array}{ll}1&\mbox{ dla }n=0\\(n-1)!\cdot n&\mbox{ dla }n\geq1\end{array}\right.$
			\item ci¹g arytmetyczny: $\displaystyle a_n=\left\{\begin{array}{ll}a&\mbox{ dla }n=0\\a_{n-1}+r&\mbox{ dla }n\geq1\end{array}\right.$
			\item ci¹g geometryczny: $\displaystyle g_n=\left\{\begin{array}{ll}g&\mbox{ dla }n=0\\g_{n-1}\cdot q&\mbox{ dla }n\geq1\end{array}\right.$
		\end{enumerate}
	\end{exampleblock}
	
\end{frame}


\begin{frame}

{\bf Ci¹g Fibonacciego}
		
		\begin{align*}
			F_0&=0,\ F_1=1,\\
			F_n&=F_{n-2}+F_{n-1}
		\end{align*}
		Pocz¹tkowe wyrazy: $0,1,1,2,3,5,8,13,21,34,\ldots$
		
\begin{align*}
F_0=&\,0\\
F_1=&\,1\\
F_2=&\,F_0+F_1=0+1=1\\
F_3=&\,F_1+F_2=1+1=2\\
F_4=&\,F_2+F_3=1+2=3
\end{align*}

\end{frame}



\begin{frame}

\begin{block}{Wybrane w³asnoœci ci¹gu Fibonacciego}

\begin{itemize}
\item $F_0+F_1+\ldots+F_n=F_{n+2}-1$
\item $F_0^2+F_1^2+\ldots+F_n^2=F_n\cdot F_{n+1}$
\item $F_{n+1}F_{n-1}=F_n^2+(-1)^n$
\item $F_n^2+F_{n-1}^2=F_{2n-1}$
\item $F_{n+1}F_m+F_nF_{m-1}=F_{m+n}$
\item $\lim\limits_{n\to\infty}\frac{F_{n+1}}{F_n}=\varphi$, gdzie $\varphi=\frac{1+\sqrt5}{2}$
\end{itemize}
\end{block}

\end{frame}




\begin{frame}

{\bf Ci¹g Catalana}
		
	$$C_0=1,\,C_n=\sum\limits_{i=0}^{n-1}C_iC_{n-i-1}$$

Pocz¹tkowe wyrazy: $1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862,\ldots$
\begin{align*}
C_0=&\,1\\
C_1=&\,C_0C_0=1\\
C_2=&\,C_0C_1+C_1C_0=1+1=2\\
C_3=&\,C_0C_2+C_1C_1+C_2C_0=2+1+2=5\\
C_4=&\,C_0C_3+C_1C_2+C_2C_1+C_3C_0=5+2+2+5=14
\end{align*}

\begin{block}{Twierdzenie}
Wzór jawny ci¹gu Catalana ma postaæ
$$C_n=\frac1{n+1}{2n\choose n}=\frac{(2n)!}{(n+1)!\cdot n!}.$$
\end{block}

\end{frame}




\begin{frame}

{\bf Funkcja McCarthy'ego}
	
	$$M(n)=\left\{\begin{array}{ll}M\big(M(n+11)\big)&\mbox{dla }1\leqslant n\leqslant100\\n-10&\mbox{dla }n>100\end{array}\right.$$

Pocz¹tkowe wyrazy: $\underbrace{91,91,\ldots,91}_{101},92,93,94,95,96,97,98,99,100,101,\ldots$

\end{frame}













\begin{frame}
	
	\begin{exampleblock}{Przyk³ad z {\it HAKMEM}}
		Niech $a_0$ bêdzie dowoln¹ liczb¹ i niech $a_{n+1}$ bêdzie liczb¹ liter potrzebnych do zapisu liczby $a_n$ w jêzyku angielskim.
		
		Na przyk³ad, je¿eli $a_0=33$, to otrzymujemy
		$$33\, ({\it thirty\ three})\ \to \ 11\, ({\it eleven})\ \to \ 6\, ({\it six})\ \to \ 3\, ({\it three})\ \to$$
		$$\to \ 5\, ({\it five})\ \to \ 4\, ({\it four})\ \to \ 4\, ({\it four})\ \to\ \ldots$$
	\end{exampleblock}

	\begin{exampleblock}{Przyk³ad: Problem Collatza}
		Niech $a_0$ bêdzie dowolon¹ liczb¹ ca³kowit¹ dodatni¹ i niech
		$$\displaystyle a_{n+1}=\left\{\begin{array}{ll}\frac12a_n,&\ \mbox{ gdy $a_n$ jest liczb¹ parzyst¹,}\\3a_n+1,&\ \mbox{ gdy $a_n$ jest liczb¹ nieparzyst¹}\end{array}\right.$$
		Przyk³adowy ci¹g Collatza: $12,6,3,10,5,16,8,4,2,\textcolor{red}1,4,2,1,4,\ldots$
	\end{exampleblock}
	
\end{frame}


\begin{frame}
	
	\begin{block}{Definicja}
		{\bf Jednorodn¹ liniow¹ zale¿noœci¹ rekurencyjn¹ II rzêdu o sta³ych wspó³czynnikach} nazywamy zale¿noœæ postaci
		\begin{equation}\label{jlzr}
			a_n=Aa_{n-1}+Ba_{n-2},
		\end{equation}
	gdzie $n\geq n_0$, $A,B\in\mathbb{C}$ i $B\neq0$.
	\end{block}

\bigskip

\begin{exampleblock}{Szczególne przypadki}
Jak wygl¹da postaæ ogólna równania (\ref{jlzr}) z danymi $a_0,a_1\in\mathbb{C}$ przy za³o¿eniu, ¿e\\ $A\cdot B=0$ ?
\end{exampleblock}

% Rozpisaæ co wychodzi przy A=0 i przy B=0.
	
\end{frame}

\begin{frame}
	\begin{block}{Definicja}
		{\bf Równaniem charakterystycznym} dla $$a_n=Aa_{n-1}+Ba_{n-2}$$ nazywamy równanie $r^2-Ar-B=0$. Wielomian $r^2-Ar-B$ nazywamy {\bf wielomianem charakterystycznym} zale¿noœci~\eqref{jlzr}.
	\end{block}

	\begin{exampleblock}{Przyk³ad: ci¹g Fibonacciego}
		\begin{align*}
			F_0&=0,\ F_1=1,\,F_n=F_{n-1}+F_{n-2}
		\end{align*}
		Zatem $A=B=1$. Równanie charakterystyczne ci¹gu Fibonacciego to $r^2-r-1=0$.
	\end{exampleblock}
	
\end{frame}



\begin{frame}
	
	\begin{block}{Twierdzenie (postaæ rozwi¹zania równania \eqref{jlzr})}
		Niech ci¹g $(a_n)$ spe³nia zale¿noœæ rekurencyjn¹ \eqref{jlzr}.
		\begin{itemize}
			\item Je¿eli równanie charakterystyczne dla \eqref{jlzr} ma dwa ró¿ne rozwi¹zania $r_1$ i $r_2$, to \begin{equation}\label{dwa}a_n=C\cdot r_1^n+D\cdot r_2^n.\end{equation}
			\item Je¿eli równanie charakterystyczne dla \eqref{jlzr} ma jedno rozwi¹zanie $r_0$, to \begin{equation}\label{jed}a_n=(C+Dn)\cdot r_0^n.\end{equation}
		\end{itemize}
	\end{block}

	W powy¿szym twierdzeniu wartoœci $C,D$ s¹ wyznaczalne przy pomocy warunków pocz¹tkowych (np. $a_0,\,a_1$) lub - ogólniej - przy pomocy wartoœci dowolnej pary $a_k,\,a_l$. 
	
	Znaj¹c pierwiastki wielomianu charakterystycznego oraz dwie wartoœci ci¹gu, z~równania \eqref{dwa} lub \eqref{jed} mo¿na utworzyæ uk³ad dwóch równañ liniowych z dwiema niewiadomymi ($C,D$).
	
\end{frame}


\begin{frame}
	
	\begin{exampleblock}{Przyk³ad}
		Wyznaczyæ wzór jawny ci¹gu $a_n$, je¿eli $a_0=-1$, $a_1=1$ i $a_n=4a_{n-1}-3a_{n-2}$ dla $n\geq2$.
		
		Zauwa¿my, ¿e równanie charakterystyczne ma postaæ $$r^2-4r+3=0,$$ wiêc jego pierwiastkami s¹ liczby $r_1=1$ i $r_2=3$. Zatem
		$$a_n=A\cdot1^n+B\cdot3^n,\ \mbox{ wiêc }\ a_n=A+B\cdot3^n.$$
		Podstawiaj¹c do powy¿szego wzoru wartoœci $a_0$ i $a_1$ otrzymujemy uk³ad równañ
		$$\left\{\begin{array}{l}-1=A+B\\1=A+3B\end{array}\right.,\ \mbox{ wiêc }\ \left\{\begin{array}{l}A=-2\\B=1\end{array}\right. .$$ Ostatecznie $$a_n=-2+3^n.$$
	\end{exampleblock}
	
\end{frame}


\begin{frame}
	
	\begin{exampleblock}{Przyk³ad}
		Wyznaczyæ wzór jawny ci¹gu $a_n$, je¿eli $a_1=0$, $a_2=2$ i $a_n=4a_{n-1}-4a_{n-2}$ dla $n\geq3$.
		
		Zauwa¿my, ¿e równanie charakterystyczne ma postaæ $r^2-4r+4=0,$ wiêc jego jedynym pierwiastkiem jest liczba $r_0=2$. Zatem
		$$a_n=(A+Bn)\cdot2^n.$$
		Podstawiaj¹c do powy¿szego wzoru wartoœci $a_1$ i $a_2$ otrzymujemy uk³ad równañ
		$$\left\{\begin{array}{l}0=(A+B)\cdot2\\2=(A+2B)\cdot4\end{array}\right.,\ \mbox{ wiêc }\ \left\{\begin{array}{l}A=-\frac12\\B=\frac12\end{array}\right. .$$ Ostatecznie $$a_n=\left(-\frac12+\frac12n\right)\cdot2^n,\ \mbox{ wiêc }\ a_n=(n-1)\cdot2^{n-1}.$$
	\end{exampleblock}
	
\end{frame}





\begin{frame}
	
	\begin{block}{Definicja}
		{\bf Jednorodn¹ liniow¹ zale¿noœci¹ rekurencyjn¹ $k$-tego rzêdu o sta³ych wspó³czynnikach} nazywamy zale¿noœæ postaci
		\begin{equation}\label{jlzrk}
			a_n=A_1a_{n-1}+A_2a_{n-2}+\ldots+A_ka_{n-k},
		\end{equation}
		gdzie $n\geq n_0$, $A_1,A_2,\ldots,A_k\in\mathbb{C}$ i $A_k\neq0$.
	\end{block}
	
	\begin{block}{Definicja}
		{\bf Równaniem charakterystycznym} dla \eqref{jlzrk} nazywamy równanie $$r^k-A_1r^{k-1}-A_2r^{k-2}-\ldots-A_{k-1}r-A_k=0.$$
		Lew¹ stronê powy¿szego równania nazywamy {\bf wielomianem charakterystycznym} zale¿noœci \eqref{jlzrk}.
	\end{block}
	
\end{frame}



\begin{frame}
	
	\begin{block}{Twierdzenie (postaæ rozwi¹zania równania (\ref{jlzrk}))}
		Niech ci¹g $(a_n)$ spe³nia zale¿noœæ rekurencyjn¹ (\ref{jlzrk}) i niech
		$$f(r)=(r-r_1)^{m_1}(r-r_2)^{m_2}\ldots(r-r_s)^{m_s}$$
		bêdzie jego wielomianem charakterystycznym. Wówczas
		\begin{align*}
			a_n=&\,(A_{1,1}+A_{1,2}\cdot n+\ldots+A_{1,m_1}\cdot n^{m_1-1})\cdot r_1^n+\\
			&\,+(A_{2,1}+A_{2,2}\cdot n+\ldots+A_{2,m_2}\cdot n^{m_2-1})\cdot r_2^n+\\
			&\,+\ldots+\\
			&\,+(A_{s,1}+A_{s,2}\cdot n+\ldots+A_{s,m_s}\cdot n^{m_s-1})\cdot r_s^n
		\end{align*}
	\end{block}
	
	W powy¿szym twierdzeniu wspó³czynniki $A_{i,j}$ s¹ wyznaczalne przy pomocy np. wartoœci pocz¹tkowych.
	
\end{frame}



\begin{frame}
	
	\begin{exampleblock}{Przyk³ad}
		Wyznaczyæ wzór jawny ci¹gu $a_n$, je¿eli $a_0=3$, $a_1=4$, $a_2=20$ i~$a_n=-2a_{n-1}+4a_{n-2}+8a_{n-3}$ dla $n\geq3$.
		
		Zauwa¿my, ¿e równanie charakterystyczne ma postaæ $r^3+2r^2-4r-8=0.$ Po przekszta³ceniu wielomianu do postaci iloczynowej otrzymujemy 
		$$(r-2)(r+2)^2=0.$$
		Jak widaæ, $r_1=2$ jest jednokrotnym, natomiast $r_2=-2$ dwukrotnym pierwiastkiem powy¿szego równania. Zatem
		$$a_n=A\cdot2^n+(Bn+C)\cdot (-2)^n$$ dla pewnych $A$, $B$ i $C$.
		
		Podstawiaj¹c do powy¿szego wzoru wartoœci $a_0$, $a_1$ i $a_2$ otrzymujemy uk³ad równañ
		$$\left\{\begin{array}{l}3=A+C\\4=2A-2B-2C\\20=4A+8B+4C\end{array}\right.,\ \mbox{ wiêc }\ \left\{\begin{array}{l}A=3\\B=1\\C=0\end{array}\right. .$$ Ostatecznie $a_n=3\cdot2^n+n\cdot(-2)^n$.
	\end{exampleblock}
	
\end{frame}




\end{document}